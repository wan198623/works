<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>fire</title>
    <style>
        body{
            margin:0;padding:0;
            overflow: hidden;
        }
        canvas{
            background:#000;
        }
    </style>
    <script>
        window.onload=function(){
            var canvas=document.querySelector("canvas");
            var w=window.innerWidth;
            var h=window.innerHeight;
            canvas.width=w;
            canvas.height=h;
            var cobj=canvas.getContext("2d");

            var movex=w/2;
            var movey=h/2;
            canvas.onmousemove=function(e){
                movex=e.offsetX;
                movey=e.offsetY;
            }
            function fire(){
                this.x=movex;
                this.y=movey;
                this.color="rgb(226,17,12)";
//                this.speedx=2*Math.random()-1;
                this.speedy=3*Math.random()+5;
                this.life=5;
                this.r=5+5*Math.random();
                this.speedr=1;
                this.speedl=0.5;
            }
            fire.prototype={
                draw:function(){
                    cobj.save();
                    cobj.beginPath();
                    cobj.translate(this.x,this.y);
                    cobj.fillStyle=this.color;
                    cobj.globalCompositeOperation="lighter";
                    // 目标图像和源图像
                    cobj.arc(0,0,this.r,0,Math.PI*2);
                    cobj.fill();
                    cobj.restore();
                },
                updata:function(){
                    this.x += 6*Math.random()-3;
                    this.speedy += this.speedl;
                    this.y -= this.speedy;
                    this.r -= this.speedr;
                    this.life -= this.speedl;
                }
            }


                var arr=[];
                setInterval(function(){
                    cobj.clearRect(0,0,canvas.width,canvas.height);
                    arr.push(new fire());
                    for (var i = 0; i < arr.length; i++){
                        arr[i].draw();
                        arr[i].updata();
                        if(arr[i].r < 0){
                            arr[i] = new fire();
                        }
                    }
                    if(arr.length>500){
                        arr.shift();
                    }
                },50)


        }
    </script>
</head>
<body>
<canvas>
</canvas>

</body>
</html>